<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS_Dom_EvenListener_Cuenta_Regresiva_Caracteres</title>
</head>
<body>
    <!-- 1. Agregar cuadro texto -->
    <input type="text" class="insertarMensaje">
    <!-- 2. Div contador caracteres, Misma cantidad que variable max -->
    <div>
        Caracteres pendientes <span class="ContadorCaracteres">20</span>
    </div>
    
</body>
<script>
    // 3. Variables
    const insertarMensaje = document.querySelector('.insertarMensaje');
    const contadorCaracteres = document.querySelector('.ContadorCaracteres');
    const max = 20;

    // 4. Asegurar contador de caracteres y que no se pasen
    // var = (dos argumentos) => if contenido.longitud>max falso; else true
    const asegurarContadorCaracteres = (content, max) => {
        if(content.length > max) {
            return false;
        } else {
            return true;
        }
    }

    // 5. EventListener(Oyente de eventos) rastrea cada vez que se levante una tecla
    insertarMensaje.onkeyup = function() { // Max- contador longitud contador caracteres
        contadorCaracteres.innerHTML = max-this.value.length;
        // si el valor de asegurar es max-1 deshabilitar input(insertar mensaje)
        // Si no sueltas la tecla, pero te pasas de cantidad, no deshabilita hasta que levantes
        if(!asegurarContadorCaracteres(this.value, (max-1))) {
            insertarMensaje.disabled = true;
        }
    }

</script>
</html>